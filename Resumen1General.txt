# PRECIO JUSTO - RESUMEN GENERAL DEL PROYECTO

## PROPÓSITO
App móvil Android para comparar y trackear precios de productos en diferentes comercios.
Énfasis en mostrar diferencias de precios entre tiendas, no solo "ahorros".
Sistema colaborativo donde usuarios comparten datos de precios.

## STACK TECNOLÓGICO
- Vue.js 3 (Composition API con <script setup>)
- Quasar Framework v2
- Capacitor v8 (para Android)
- Pinia (state management)
- Tabler Icons (iconografía exclusiva)
- JavaScript (NO TypeScript)

## SISTEMA DE ALMACENAMIENTO (Arquitectura de 3 capas)

### ADAPTADORES
- LocalStorageAdapter.js: Para testing web
- CapacitorAdapter.js: Para móvil (SQLite nativo)
- FirestoreAdapter.js: Futuro (nube colaborativa)

### SERVICIOS
- AlmacenamientoService.js: Configuración central de adaptadores
- ProductosService.js: CRUD y lógica de negocio de productos
- ConfirmacionesService.js: Lógica de upvotes (1 por usuario por precio)
- OpenFoodFactsService.js: Integración con API para búsqueda de productos
- PreferenciasService.js: Gestión de configuraciones del usuario

### STORES (PINIA)
- productosStore.js: Estado global de productos
- confirmacionesStore.js: Estado global de confirmaciones

### CAMBIO DE ADAPTADOR
Modificar ADAPTADOR_ACTIVO en AlmacenamientoService.js
Opciones: 'local' | 'capacitor' | 'firestore'

### SEED
- seed.js: Script para poblar 4 productos de prueba
- ejecutarSeed(): Carga productos hardcodeados
- limpiarDatos(): Elimina todos los productos

### CONFIGURACIÓN QUASAR
- Notify plugin habilitado en quasar.config.js

### IDS DE PRODUCTOS
- Generados como strings alfanuméricos (Date.now() + random)
- NO usar parseInt() en rutas dinámicas
- Formato: "17688640000082zwcohe41y"

## SISTEMA DE DEDUPLICACIÓN

### OBJETIVO
Evitar productos duplicados en la base de datos.
1 PRODUCTO = 1 TARJETA (sin importar cuántos comercios tenga precios)

### CRITERIO DE COINCIDENCIA
**Prioridad 1:** Código de barras (más confiable)
- Si código de barras coincide → ES EL MISMO PRODUCTO

### IMPLEMENTACIÓN ACTUAL
**ProductosService.js:**
- Método `buscarPorCodigoBarras(codigo)`: Busca producto existente por código

**DialogoAgregarProducto.vue:**
- ANTES de guardar, busca si existe producto con el mismo código
- Si existe → Agrega precio al producto existente (mantiene historial completo)
- Si NO existe → Crea producto nuevo

### FLUJO DE GUARDADO
```
1. Usuario completa formulario (manual o con API)
2. Click en "Guardar Producto"
3. Sistema busca código de barras en productos existentes
   ↓
   ├─ ENCONTRADO → Agregar precio al existente
   │               Notificación: "Precio agregado a [nombre]"
   │               Mostrar: comercio y valor agregado
   ↓
   └─ NO ENCONTRADO → Crear producto nuevo
                      Notificación: "Producto agregado exitosamente"
```

### RESULTADO
```
❌ ANTES:
- Tarjeta: "Coca Cola" (código: 7790123, TATA $150)
- Tarjeta: "Coca Cola" (código: 7790123, DISCO $160)

✅ AHORA:
- Tarjeta: "Coca Cola" (código: 7790123)
  → Precio en TATA: $150
  → Precio en DISCO: $160
```

### PRÓXIMAS FASES (PLANIFICADO)
- Deduplicación por nombre + marca (cuando no hay código)
- Búsqueda inteligente mientras escribe (autocompletado)
- Normalización de texto (mayúsculas, tildes, espacios)
- Diálogo de confirmación para productos similares

## ALMACENAMIENTO DE DATOS
- Fase 1 (MVP): Capacitor Storage + localStorage (confirmaciones de usuario)
- Fase 2: Firebase/Firestore (nube con privacidad configurable)

## ESTRUCTURA DE ARCHIVOS
src/
├── App.vue
├── css/
│   ├── app.css
│   └── variables.css
├── layouts/
│   └── MainLayout.vue
├── pages/
│   ├── ErrorNotFound.vue
│   ├── IndexPage.vue
│   ├── MisProductosPage.vue
│   └── DetalleProductoPage.vue
├── router/
│   ├── index.js
│   └── routes.js
├── components/
│   ├── EssentialLink.vue
│   ├── Tarjetas/
│   │   └── TarjetaProducto.vue
│   ├── MisProductos/
│   │   └── ListaProductos.vue
│   ├── DetalleProducto/
│   │   ├── InfoProducto.vue
│   │   ├── EstadisticasProducto.vue
│   │   ├── FiltrosHistorial.vue
│   │   ├── HistorialPrecios.vue
│   │   ├── ItemComercioHistorial.vue
│   │   └── ItemPrecioHistorial.vue
│   └── Formularios/
│       ├── FormularioProducto.vue
│       ├── FormularioPrecio.vue
│       └── Dialogos/
│           ├── DialogoAgregarProducto.vue
│           └── DialogoResultadosBusqueda.vue
└── almacenamiento/
    ├── adaptadores/
    │   ├── LocalStorageAdapter.js
    │   ├── CapacitorAdapter.js
    │   └── FirestoreAdapter.js (futuro)
    ├── servicios/
    │   ├── AlmacenamientoService.js
    │   ├── ProductosService.js
    │   ├── ConfirmacionesService.js
    │   ├── OpenFoodFactsService.js
    │   └── PreferenciasService.js
    └── stores/
        ├── productosStore.js
        └── confirmacionesStore.js

## CONVENCIONES DE NOMENCLATURA
- Carpetas y archivos: PascalCase (ejemplo: MisProductos/, TarjetaProducto.vue)
- Variables/funciones: camelCase en español (ejemplo: productosEjemplo, toggleExpandir)
- Nombres descriptivos y en español

## PALETA DE COLORES
- Primario: #1976D2 (azul oscuro)
- Secundario: #4CAF50 (verde - ahorro/positivo)
- Acento: #FF9800 (naranja - alertas)
- Fondo app: #EEEEEE (gris medio)
- Fondo tarjeta: #FFFFFF

## FEATURES IMPLEMENTADAS
- Sistema de tarjetas de productos expandibles
- Navegación con Vue Router
- Página de historial completo por producto
- Sistema de confirmaciones con localStorage (1 vez por usuario por precio)
- Tendencias individuales por comercio
- Filtros avanzados (comercio, período, ordenamiento)
- Indicadores de frescura por antigüedad (colores automáticos)
- Integración con Open Food Facts API (búsqueda por código y nombre)
- Auto-completado de formularios con datos de API
- **Sistema de deduplicación por código de barras**
- **Unificación automática de productos idénticos**
- Preferencias de usuario persistentes (moneda, unidad)

## FEATURES PLANIFICADAS
- Escaneo de código de barras/QR (FAB)
- Sistema de favoritos/listas (NO eliminar productos)
- Geolocalización para comercios cercanos
- Control de privacidad de datos compartidos
- Monetización: Google AdMob
- Import/Export de datos
- Deduplicación por nombre + marca (inteligente)
- Búsqueda con autocompletado mientras escribe
- Normalización de texto para detección de duplicados