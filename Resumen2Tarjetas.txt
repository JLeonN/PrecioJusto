# TARJETAS DE PRODUCTOS - DOCUMENTACIÓN TÉCNICA

## COMPONENTES RELACIONADOS
- TarjetaProducto.vue (componente reutilizable en /components/Tarjetas/)
- ListaProductos.vue (contenedor en /components/MisProductos/)
- BarraSeleccion.vue (barra sticky para modo selección en /components/Seleccion/)
- BarraAccionesSeleccion.vue (barra fixed bottom en /components/Seleccion/)

## MODO SELECCIÓN

### ACTIVACIÓN
- Long-press de 1 segundo en cualquier tarjeta
- Vibración háptica en móvil al activar
- Primera tarjeta presionada queda seleccionada automáticamente

### COMPORTAMIENTO VISUAL
- Checkbox circular en esquina superior derecha
- Overlay verde semi-transparente (--color-secundario-claro)
- Borde verde (--color-secundario) cuando está seleccionada
- Animación fade-in del checkbox (0.3s)

### COMPORTAMIENTO DE CLICK
- Modo selección activo: tap simple marca/desmarca
- Modo normal: tap simple expande/colapsa
- Botón "Agregar precio" oculto en modo selección
- Sección expandida oculta en modo selección
- Ícono chevron oculto en modo selección

### PROPS NUEVAS
- modoSeleccion (Boolean): Indica si está en modo selección
- seleccionado (Boolean): Indica si esta tarjeta está seleccionada

### EVENTOS NUEVOS
- 'long-press': Emitido al hacer long-press (1 seg)
- 'toggle-seleccion': Emitido al hacer tap en modo selección

### BARRAS DE INTERFAZ
- BarraSeleccion: Sticky debajo del header, muestra contador y botón "Seleccionar todo"
- BarraAccionesSeleccion: Fixed bottom con botones "Eliminar" y "Cancelar"

### COMPOSABLE REUTILIZABLE
- useSeleccionMultiple.js: Lógica completa de selección múltiple
- Reutilizable en cualquier página con listas
- Maneja estado, métodos de selección, y eventos

## ESTRUCTURA DE DATOS DEL PRODUCTO
Cada producto requiere:
- id (number)
- nombre (string)
- imagen (string | null)
- codigoBarras (string | null)
- precioMejor (number)
- comercioMejor (string)
- diferenciaPrecio (number)
- precios (array de objetos):
  - comercio (string)
  - valor (number)
  - fecha (string)
  - esMejor (boolean)

## CÓDIGO DE BARRAS COPIABLE
- Muestra debajo del nombre con ícono IconBarcode (14px)
- Click para copiar al portapapeles con notificación Quasar
- Tooltip "Click para copiar" al hacer hover
- Feedback visual con background hover/active
- Fuente monoespaciada (Courier New, 11px)
- Solo visible si producto tiene codigoBarras

## COMPORTAMIENTO VISUAL

### ESTADO COLAPSADO (default)
- Muestra: imagen/placeholder, nombre, código de barras (si existe), mejor precio, comercio del mejor precio
- Botón "Agregar precio" en modo redondo (solo ícono)
- Ícono chevron-down indicando expandible
- Click en tarjeta expande/colapsa (solo en modo normal)

### ESTADO EXPANDIDO
- Muestra top 3 mejores precios ordenados por valor
- Botón "Agregar precio" expandido con texto
- Lista con avatares numerados (1,2,3)
- Avatar verde para el mejor precio
- Fechas formateadas en modo relativo (Hace X días/horas/semanas)
- Botón "Ver historial completo" al final
- Ícono chevron-up indicando colapsable

## DISEÑO RESPONSIVO

### MÓVIL (xs)
- Layout vertical (flex-direction: column)
- Imagen: 140px x 140px centrada
- Info apilada verticalmente

### TABLET/PC (gt.xs)
- Layout horizontal (grid 3 columnas: 80px | 1fr | auto)
- Imagen: 80px x 80px
- Info y controles en línea

## INTERACCIONES
- Click en tarjeta (modo normal): toggleExpandir()
- Click en tarjeta (modo selección): emit('toggle-seleccion')
- Long-press 1 segundo: emit('long-press') + vibración háptica
- Click en botón agregar: emit('agregar-precio') con stop propagation
- Click en código de barras: copiar al portapapeles con notificación
- Click en "Ver historial": emit('ver-detalle') con stop propagation
- Animación de presión (scale 0.98) en :active

## ESTILOS CLAVE
- Borde izquierdo azul (4px) marca visual (modo normal)
- Borde verde (4px) + box-shadow verde (modo seleccionado)
- Overlay verde semi-transparente cuando está seleccionada
- Transiciones suaves (0.2s - 0.3s)
- Botón agregar con transición de ancho y texto (fade)
- Texto nombre: ellipsis 2 líneas
- Texto comercio: ellipsis 1 línea

## ICONOGRAFÍA (Tabler Icons)
- IconShoppingBag: placeholder imagen
- IconMapPin: ubicación comercio
- IconPlus: agregar precio
- IconChevronDown/Up: expandir/colapsar
- IconChartLine: ver historial
- IconBarcode: código de barras

## EVENTOS EMITIDOS
- 'agregar-precio': cuando se clickea botón agregar
- 'ver-detalle': cuando se clickea ver historial completo
- 'long-press': cuando se mantiene presionado 1 segundo (activa modo selección)
- 'toggle-seleccion': cuando se hace tap en modo selección (marca/desmarca)

## COMPUTED PROPERTIES
- top3Precios: ordena precios por valor ASC y toma primeros 3
- clasesResponsivas: determina layout según $q.screen

## FUNCIONES
- formatearFecha(): Convierte fechas ISO a formato relativo
- copiarCodigoBarras(): Copia código al portapapeles con notificación

## LIMITACIONES ACTUALES
- Solo muestra top 3 en expansión (no scroll infinito)
- No hay funcionalidad de menú contextual aún

## INTEGRACIÓN CON STORES

### DATOS
- ListaProductos recibe productos desde productosStore
- Datos reactivos: cambios en store actualizan UI automáticamente

### CARGA DE DATOS
- MisProductosPage.vue carga productos con productosStore.cargarProductos()
- Estados de carga y error manejados por el store

### SELECCIÓN MÚLTIPLE
- Composable useSeleccionMultiple maneja estado de selección
- MisProductosPage pasa props modoSeleccion y seleccionados a ListaProductos
- ListaProductos verifica si cada producto está seleccionado
- TarjetaProducto muestra visual según estado de selección

### ELIMINACIÓN
- Eliminación múltiple con diálogo de confirmación
- Notificación con botón "Deshacer" (5 segundos timeout)
- Productos guardados en caché temporal para restaurar
- Animación fade-out al eliminar (integrada con Quasar)