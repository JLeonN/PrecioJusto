# PLAN DE TRABAJO - SECCIÃ“N COMERCIOS
Proyecto: Precio Justo
Fecha inicio: 29 de Enero 2025
Responsable: Leo + CH

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“– DESCRIPCIÃ“N DEL PLAN

Este plan detalla la implementaciÃ³n completa de la nueva secciÃ³n "COMERCIOS" 
en la aplicaciÃ³n Precio Justo. El objetivo principal es crear una base de 
datos maestra de comercios que elimine duplicados y mejore la calidad de 
los datos ingresados por los usuarios.

### OBJETIVOS PRINCIPALES:
- Centralizar la gestiÃ³n de comercios en una secciÃ³n dedicada
- Eliminar duplicados mediante validaciÃ³n inteligente (3 niveles)
- Mejorar la experiencia al agregar precios con autocompletado
- Ordenar comercios/direcciones por Ãºltimos usados
- Reutilizar sistema de selecciÃ³n mÃºltiple para eliminar comercios

### CARACTERÃSTICAS CLAVE:
- ValidaciÃ³n de duplicados por nombre + direcciÃ³n
- Algoritmo de similitud de texto (Levenshtein distance)
- NormalizaciÃ³n automÃ¡tica (minÃºsculas, tildes, abreviaturas)
- Autocompletado inteligente ordenado por uso reciente
- Tarjetas estilo "carta vertical" responsivas
- Soporte para mÃºltiples direcciones por comercio
- Placeholder para foto del comercio (cÃ¡mara en fase futura)
- EliminaciÃ³n con motivo (cerrÃ³/duplicado/otro)

### TECNOLOGÃAS:
- Vue.js 3 + Composition API
- Quasar Framework (q-select, q-input, q-dialog)
- Pinia (comerciosStore)
- Capacitor Storage
- Tabler Icons

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âœ… FASE 1: BASE DE DATOS Y SERVICIOS âš™ï¸ [COMPLETADA]

### ComerciosService.js
[x] Crear archivo en src/almacenamiento/servicios/
[x] Implementar obtenerTodos()
[x] Implementar buscarPorNombre()
[x] Implementar buscarPorId()
[x] Implementar agregarComercio()
[x] Implementar editarComercio()
[x] Implementar eliminarComercio()
[x] Implementar agregarDireccion()
[x] Implementar eliminarDireccion()
[x] Implementar validarDuplicados() (algoritmo 3 niveles)
[x] Implementar normalizar() (minÃºsculas, tildes, espacios)
[x] Implementar similitudTexto() (Levenshtein distance)
[x] Implementar expandirAbreviaturas()
[x] Implementar registrarUsoComercio() (para orden Ãºltimos usados)
[x] Implementar obtenerComercioPorUso() (ordenados por fecha)

### comerciosStore.js
[x] Crear archivo en src/almacenamiento/stores/
[x] Definir state (comercios, cargando, error)
[x] Implementar cargarComercios()
[x] Implementar agregarComercio()
[x] Implementar editarComercio()
[x] Implementar eliminarComercio()
[x] Implementar buscarComercios()
[x] Implementar obtenerComercioPorId()
[x] Integrar con ComerciosService

### EXTRAS IMPLEMENTADOS (no estaban en el plan original):
[x] MÃ©todo eliminarComercios() (eliminaciÃ³n mÃºltiple)
[x] MÃ©todo agregarDireccion() en store
[x] MÃ©todo eliminarDireccion() en store
[x] MÃ©todo registrarUso() en store
[x] MÃ©todo validarDuplicados() en store
[x] Getters: comerciosPorUso, totalComercios, totalDirecciones, comerciosPorTipo

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âœ… FASE 2: ESTRUCTURA DE ARCHIVOS ğŸ“ [COMPLETADA]

### ReorganizaciÃ³n de carpetas
[x] Crear carpeta src/components/Compartidos/
[x] Mover BarraSeleccion.vue a Compartidos/
[x] Mover BarraAccionesSeleccion.vue a Compartidos/
[x] Actualizar imports en MisProductosPage.vue
[x] Crear carpeta src/components/Comercios/

### Nuevos archivos
[x] Crear src/pages/ComerciosPage.vue
[x] Crear src/components/Comercios/ListaComercios.vue
[x] Crear src/components/Comercios/TarjetaComercio.vue
[x] Crear src/components/Formularios/FormularioComercio.vue
[x] Crear src/components/Formularios/Dialogos/DialogoAgregarComercio.vue
[x] Crear src/components/Formularios/Dialogos/DialogoCoincidencias.vue
[x] Crear src/components/Formularios/Dialogos/DialogoMismaUbicacion.vue
[x] Crear src/components/Formularios/Dialogos/DialogoMotivoEliminacion.vue

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âœ… FASE 3: UI - PÃGINA DE COMERCIOS ğŸ¨ [COMPLETADA]

### ComerciosPage.vue
[x] Crear estructura bÃ¡sica del layout
[x] Importar ListaComercios
[x] Implementar carga de comercios desde store
[x] Agregar botÃ³n FAB para nuevo comercio
[x] Implementar estados: cargando, vacÃ­o, error
[x] Agregar barra de bÃºsqueda
[x] Integrar modo selecciÃ³n mÃºltiple
[x] Conectar con BarraSeleccion (Compartidos)
[x] Conectar con BarraAccionesSeleccion (Compartidos)

### ListaComercios.vue
[x] Crear componente contenedor
[x] Recibir props: comercios, modoSeleccion, seleccionados
[x] Renderizar TarjetaComercio por cada comercio
[x] Implementar mensaje "No hay comercios"
[x] Manejar eventos de selecciÃ³n
[x] Agregar animaciones de entrada/salida

### TarjetaComercio.vue
[x] Crear estructura bÃ¡sica (layout vertical tipo carta)
[x] Agregar placeholder foto (IconBuilding de Tabler)
[x] Mostrar nombre del comercio
[x] Mostrar tipo de comercio
[x] Mostrar cantidad de direcciones
[x] Implementar estado expandido/colapsado
[x] Mostrar lista de direcciones al expandir
[x] Agregar botÃ³n "Editar" (solo expandido)
[x] Implementar modo selecciÃ³n (checkbox circular)
[x] Implementar long-press (1 segundo)
[x] Agregar estilos responsivos
[x] Agregar animaciones de hover/active
[x] Implementar vibraciÃ³n hÃ¡ptica (Capacitor)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âœ… FASE 4: FORMULARIOS Y VALIDACIONES ğŸ“ [COMPLETADA]

### FormularioComercio.vue
[x] Crear estructura del formulario
[x] Campo: Nombre (q-input obligatorio)
[x] Campo: Tipo (q-select con opciones predefinidas + "Otro")
[x] Campo: Calle y nÃºmero (q-input obligatorio)
[x] Campo: Barrio (q-input opcional)
[x] Campo: Ciudad (q-input opcional)
[x] BotÃ³n placeholder cÃ¡mara (deshabilitado por ahora)
[x] Implementar validaciones bÃ¡sicas
[x] Implementar validaciÃ³n de duplicados (al escribir)
[x] Mostrar feedback visual de validaciÃ³n
[x] MÃ©todo limpiarFormulario()
[x] MÃ©todo validarFormulario()
[x] Emitir evento 'guardar' con datos

### DialogoAgregarComercio.vue
[x] Crear estructura del diÃ¡logo (q-dialog)
[x] Importar FormularioComercio
[x] Implementar botones Guardar/Cancelar
[x] Conectar con comerciosStore.agregarComercio()
[x] Manejar loading al guardar
[x] Mostrar notificaciones (success/error)
[x] Cerrar diÃ¡logo despuÃ©s de guardar
[x] Implementar prop modelValue para v-model

### DialogoCoincidencias.vue
[x] Crear diÃ¡logo de advertencia
[x] Mostrar lista de comercios similares
[x] Mostrar porcentaje de similitud
[x] Botones: "Usar existente" / "Es nuevo, continuar"
[x] Emitir evento con decisiÃ³n del usuario
[x] DiseÃ±o visual claro y amigable

### DialogoMismaUbicacion.vue
[x] Crear diÃ¡logo informativo
[x] Mostrar comercios en misma direcciÃ³n
[x] Explicar que puede ser mismo edificio
[x] Botones: "SÃ­, agregar" / "Cancelar"
[x] Emitir evento con confirmaciÃ³n

### DialogoMotivoEliminacion.vue
[x] Crear diÃ¡logo de confirmaciÃ³n
[x] Radio buttons con opciones:
  [x] - "CerrÃ³ definitivamente"
  [x] - "Error / Duplicado"
  [x] - "Otro motivo"
[x] Campo texto para "Otro motivo"
[x] Mostrar cantidad de productos afectados
[x] Botones: "Confirmar eliminaciÃ³n" / "Cancelar"
[x] Emitir evento con motivo seleccionado

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âœ… FASE 5: INTEGRACIÃ“N CON PRECIOS ğŸ”— [COMPLETADA]

### Modificar FormularioPrecio.vue
[x] Reemplazar q-input comercio por q-select
[x] Configurar q-select con use-input
[x] Implementar @filter para bÃºsqueda
[x] Cargar comercios desde comerciosStore.comerciosPorUso
[x] Mostrar cantidad de direcciones en cada opciÃ³n
[x] Agregar opciÃ³n "Agregar nuevo comercio"
[x] Reemplazar q-input direcciÃ³n por q-select
[x] Cargar direcciones del comercio seleccionado
[x] Auto-seleccionar direcciÃ³n mÃ¡s usada
[x] Detectar cuando usuario escribe direcciÃ³n nueva
[x] Abrir DialogoDireccionNueva cuando no coincide
[x] Emitir comercioId y direccionId adicionales

### Crear DialogoDireccionNueva.vue
[x] Crear componente de diÃ¡logo
[x] Mostrar comercio y direcciÃ³n escrita
[x] BotÃ³n: "Agregar a comercio existente"
[x] BotÃ³n: "Crear comercio nuevo"
[x] BotÃ³n: "Cancelar"
[x] Emitir eventos correspondientes
[x] LÃ³gica de agregar direcciÃ³n a existente
[x] LÃ³gica de crear comercio nuevo

### Actualizar ProductosService.js
[x] Modificar agregarPrecio() para aceptar comercioId/direccionId
[x] Mantener compatibilidad con strings comercio/direccion
[x] Validar nuevos campos
[x] Fallback para datos legacy

### Integrar en DialogoAgregarProducto.vue
[x] Importar comerciosStore
[x] Registrar uso con comerciosStore.registrarUso()
[x] Llamar despuÃ©s de guardar producto existente
[x] Llamar despuÃ©s de guardar producto nuevo
[x] Validar que tenga comercioId y direccionId

### Estilos globales
[x] Agregar variables CSS en Variables.css
[x] Agregar clases en app.css
[x] Aplicar en formularios

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## â¸ï¸ FASE 6: ELIMINACIÃ“N MÃšLTIPLE âœ… [PENDIENTE]

### Integrar selecciÃ³n mÃºltiple
[ ] Verificar useSeleccionMultiple.js funciona
[ ] Importar en ComerciosPage
[ ] Implementar handleLongPress
[ ] Implementar handleToggleSeleccion
[ ] Implementar seleccionarTodos
[ ] Implementar cancelarSeleccion

### Eliminar comercios con validaciÃ³n
[ ] Abrir DialogoMotivoEliminacion
[ ] Validar si comercios tienen productos asociados
[ ] Mostrar advertencia si tienen productos
[ ] SegÃºn motivo:
  [ ] - CerrÃ³: Marcar productos (mantener historial)
  [ ] - Duplicado: Reasignar a otro comercio
  [ ] - Otro: Mantener precios con nombre original
[ ] Implementar eliminaciÃ³n con animaciÃ³n
[ ] NotificaciÃ³n con botÃ³n "Deshacer" (5 seg)
[ ] Restaurar si elige deshacer

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âœ… FASE 7: ROUTER Y NAVEGACIÃ“N ğŸ—ºï¸ [COMPLETADA]

### Actualizar routes.js
[x] Agregar ruta /comercios
[x] Configurar ComerciosPage como componente
[x] Verificar navegaciÃ³n desde drawer

### Actualizar MainLayout.vue
[x] Verificar que el item "Comercios" tenga to="/comercios"
[x] Confirmar que funciona la navegaciÃ³n

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âœ… FASE 7.5: SISTEMA DE DISEÃ‘O CSS ğŸ¨ [COMPLETADA - NUEVA FASE]

### Centralizar CSS en app.css
[x] Extraer clase .contenedor-pagina (max-width 1200px)
[x] Extraer clases de headers (.header-pagina, .titulo-pagina, .contador-items)
[x] Crear clase .buscador-centrado (max-width 500px, centrado)
[x] Aplicar en MisProductosPage.vue
[x] Aplicar en ComerciosPage.vue
[x] Eliminar estilos scoped duplicados
[x] Documentar en comentarios CSS

### Migrar a sistema de grid Quasar
[x] ListaProductos.vue: usar row + col-12 col-sm-6 col-md-4 col-xl-3
[x] ListaComercios.vue: usar row + col-12 col-sm-6 col-md-4 col-xl-3
[x] Eliminar grid CSS custom
[x] Verificar responsividad en todos los breakpoints

### Beneficios implementados
[x] DRY (Don't Repeat Yourself)
[x] Consistencia visual entre pÃ¡ginas
[x] Mantenimiento centralizado
[x] Base para Design System completo

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸš§ FASE 8: TESTING Y AJUSTES ğŸ§ª [50% COMPLETADA]

### Testing funcional
[x] Crear comercio nuevo
[ ] Editar comercio existente
[ ] Agregar direcciÃ³n a comercio
[ ] Eliminar direcciÃ³n de comercio
[ ] ValidaciÃ³n de duplicados exactos
[ ] ValidaciÃ³n de direcciones similares
[ ] ValidaciÃ³n de misma ubicaciÃ³n
[x] BÃºsqueda de comercios
[x] Filtrado en tiempo real
[ ] Orden por Ãºltimos usados
[x] SelecciÃ³n mÃºltiple
[ ] EliminaciÃ³n con motivo
[ ] IntegraciÃ³n con FormularioPrecio
[ ] Autocompletado de direcciones
[x] NavegaciÃ³n entre pÃ¡ginas

### Testing responsivo
[x] MÃ³vil (xs) - 360px
[x] Tablet (sm) - 768px (via grid Quasar)
[x] Desktop (md) - 1024px (via grid Quasar)
[x] Desktop XL (xl) - 1920px (via grid Quasar)

### Optimizaciones
[ ] Revisar performance de bÃºsqueda
[ ] Optimizar re-renders
[ ] Verificar memoria (no memory leaks)
[ ] Lazy loading de imÃ¡genes (futuro)

### Testing adicional completado âœ…
[x] Guardar y persistir en Capacitor Storage
[x] Listar comercios guardados despuÃ©s de recargar
[x] Expandir/colapsar tarjetas
[x] ExpansiÃ³n flotante sin mover otras tarjetas
[x] Bordes continuos al expandir
[x] Formato de fecha relativa en direcciones
[x] Sistema CSS centralizado
[x] Buscador centrado con padding correcto
[x] Headers consistentes entre pÃ¡ginas
[x] Grid responsivo en todos los breakpoints

### Testing de Sistema de DiseÃ±o âœ…
[x] Clase .contenedor-pagina funciona en ambas pÃ¡ginas
[x] Headers con clases globales (.titulo-pagina, .contador-items)
[x] Buscador centrado con padding adecuado
[x] Grid Quasar responsivo (4 breakpoints)
[x] Variables CSS aplicadas correctamente

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## â¸ï¸ FASE 9: DOCUMENTACIÃ“N ğŸ“š [PENDIENTE]

### Actualizar ResÃºmenes
[x] Actualizar Resumen1General.txt (Sistema de DiseÃ±o agregado)
[x] Actualizar PlanTrabajoComercio.txt (este archivo)
[ ] Crear Resumen5Comercios.txt (pendiente)
[ ] Actualizar Resumen4FormularioAgregar.txt (integraciÃ³n)

### Comentarios en cÃ³digo
[ ] Documentar funciones complejas
[ ] Agregar JSDoc donde sea necesario
[ ] Comentar algoritmos de validaciÃ³n

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## NOTAS IMPORTANTES ğŸ“Œ

- Fase 1 (Base de datos) âœ… COMPLETADA
- Fase 2 (Estructura) âœ… COMPLETADA
- Fase 3 (UI PÃ¡gina) âœ… COMPLETADA
- Fase 4 (Formularios) âœ… COMPLETADA
- Fase 7 (Router) âœ… COMPLETADA
- Fase 7.5 (CSS) âœ… COMPLETADA (nueva fase)
- Fase 8 (Testing) ğŸš§ 50% COMPLETADA
- No implementar cÃ¡mara todavÃ­a (placeholder solamente)
- Reutilizar componentes de selecciÃ³n mÃºltiple âœ… HECHO
- Mantener consistencia con diseÃ±o actual âœ… HECHO
- Sistema de diseÃ±o centralizado âœ… IMPLEMENTADO
- Probar cada fase antes de seguir a la siguiente
- Guardar progreso con commits frecuentes

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## MEJORAS IMPLEMENTADAS NO PLANIFICADAS ğŸ

### Sistema de DiseÃ±o Centralizado (Fase 7.5)
[x] Clases CSS globales en app.css
[x] Contenedor de pÃ¡gina reutilizable
[x] Headers estandarizados
[x] Buscador centrado estilo Google
[x] Grid responsivo Quasar
[x] Variables CSS centralizadas
[x] DocumentaciÃ³n de clases globales

### Optimizaciones de UX
[x] ExpansiÃ³n flotante en TarjetaComercio
[x] Bordes continuos al expandir
[x] Padding correcto en buscador
[x] Consistencia visual total

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## PRÃ“XIMAS MEJORAS (POST-MVP) ğŸš€

[ ] Implementar plugin de cÃ¡mara
[ ] Subir fotos de comercios
[ ] GeolocalizaciÃ³n de comercios
[ ] Mapa de comercios cercanos
[ ] Compartir comercios entre usuarios
[ ] Sistema de reportes de comercios cerrados
[ ] VerificaciÃ³n de comercios (badges)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“Š PROGRESO GENERAL: 83% COMPLETADO

âœ… Fase 1: 100%
âœ… Fase 2: 100%
âœ… Fase 3: 100%
âœ… Fase 4: 100%
âœ… Fase 5: 100%
â¸ï¸ Fase 6: 0%
âœ… Fase 7: 100%
âœ… Fase 7.5: 100%
ğŸš§ Fase 8: 50%
â¸ï¸ Fase 9: 20%

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

**ÃšLTIMA ACTUALIZACIÃ“N:** 04 de Febrero 2026 - Fase 5 completada
