# PLAN DE TRABAJO - SECCIÃ“N COMERCIOS
Proyecto: Precio Justo
Fecha inicio: 29 de Enero 2025
Responsable: Leo + CH

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“– DESCRIPCIÃ“N DEL PLAN

Este plan detalla la implementaciÃ³n completa de la nueva secciÃ³n "COMERCIOS" 
en la aplicaciÃ³n Precio Justo. El objetivo principal es crear una base de 
datos maestra de comercios que elimine duplicados y mejore la calidad de 
los datos ingresados por los usuarios.

### OBJETIVOS PRINCIPALES:
- Centralizar la gestiÃ³n de comercios en una secciÃ³n dedicada
- Eliminar duplicados mediante validaciÃ³n inteligente (3 niveles)
- Mejorar la experiencia al agregar precios con autocompletado
- Ordenar comercios/direcciones por Ãºltimos usados
- Reutilizar sistema de selecciÃ³n mÃºltiple para eliminar comercios

### CARACTERÃSTICAS CLAVE:
- ValidaciÃ³n de duplicados por nombre + direcciÃ³n
- Algoritmo de similitud de texto (Levenshtein distance)
- NormalizaciÃ³n automÃ¡tica (minÃºsculas, tildes, abreviaturas)
- Autocompletado inteligente ordenado por uso reciente
- Tarjetas estilo "carta vertical" responsivas
- Soporte para mÃºltiples direcciones por comercio
- Placeholder para foto del comercio (cÃ¡mara en fase futura)
- EliminaciÃ³n con motivo (cerrÃ³/duplicado/otro)

### TECNOLOGÃAS:
- Vue.js 3 + Composition API
- Quasar Framework (q-select, q-input, q-dialog)
- Pinia (comerciosStore)
- Capacitor Storage
- Tabler Icons

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âœ… FASE 1: BASE DE DATOS Y SERVICIOS âš™ï¸ [COMPLETADA]

### ComerciosService.js
[x] Crear archivo en src/almacenamiento/servicios/
[x] Implementar obtenerTodos()
[x] Implementar buscarPorNombre()
[x] Implementar buscarPorId()
[x] Implementar agregarComercio()
[x] Implementar editarComercio()
[x] Implementar eliminarComercio()
[x] Implementar agregarDireccion()
[x] Implementar eliminarDireccion()
[x] Implementar validarDuplicados() (algoritmo 3 niveles)
[x] Implementar normalizar() (minÃºsculas, tildes, espacios)
[x] Implementar similitudTexto() (Levenshtein distance)
[x] Implementar expandirAbreviaturas()
[x] Implementar registrarUsoComercio() (para orden Ãºltimos usados)
[x] Implementar obtenerComercioPorUso() (ordenados por fecha)

### comerciosStore.js
[x] Crear archivo en src/almacenamiento/stores/
[x] Definir state (comercios, cargando, error)
[x] Implementar cargarComercios()
[x] Implementar agregarComercio()
[x] Implementar editarComercio()
[x] Implementar eliminarComercio()
[x] Implementar buscarComercios()
[x] Implementar obtenerComercioPorId()
[x] Integrar con ComerciosService

### EXTRAS IMPLEMENTADOS (no estaban en el plan original):
[x] MÃ©todo eliminarComercios() (eliminaciÃ³n mÃºltiple)
[x] MÃ©todo agregarDireccion() en store
[x] MÃ©todo eliminarDireccion() en store
[x] MÃ©todo registrarUso() en store
[x] MÃ©todo validarDuplicados() en store
[x] Getters: comerciosPorUso, totalComercios, totalDirecciones, comerciosPorTipo

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âœ… FASE 2: ESTRUCTURA DE ARCHIVOS ğŸ“ [COMPLETADA]

### ReorganizaciÃ³n de carpetas
[x] Crear carpeta src/components/Compartidos/
[x] Mover BarraSeleccion.vue a Compartidos/
[x] Mover BarraAccionesSeleccion.vue a Compartidos/
[x] Actualizar imports en MisProductosPage.vue
[x] Crear carpeta src/components/Comercios/

### Nuevos archivos
[x] Crear src/pages/ComerciosPage.vue
[x] Crear src/components/Comercios/ListaComercios.vue
[x] Crear src/components/Comercios/TarjetaComercio.vue
[x] Crear src/components/Formularios/FormularioComercio.vue
[x] Crear src/components/Formularios/Dialogos/DialogoAgregarComercio.vue
[x] Crear src/components/Formularios/Dialogos/DialogoCoincidencias.vue
[x] Crear src/components/Formularios/Dialogos/DialogoMismaUbicacion.vue
[x] Crear src/components/Formularios/Dialogos/DialogoMotivoEliminacion.vue

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âœ… FASE 3: UI - PÃGINA DE COMERCIOS ğŸ¨ [COMPLETADA]

### ComerciosPage.vue
[x] Crear estructura bÃ¡sica del layout
[x] Importar ListaComercios
[x] Implementar carga de comercios desde store
[x] Agregar botÃ³n FAB para nuevo comercio
[x] Implementar estados: cargando, vacÃ­o, error
[x] Agregar barra de bÃºsqueda
[x] Integrar modo selecciÃ³n mÃºltiple
[x] Conectar con BarraSeleccion (Compartidos)
[x] Conectar con BarraAccionesSeleccion (Compartidos)

### ListaComercios.vue
[x] Crear componente contenedor
[x] Recibir props: comercios, modoSeleccion, seleccionados
[x] Renderizar TarjetaComercio por cada comercio
[x] Implementar mensaje "No hay comercios"
[x] Manejar eventos de selecciÃ³n
[x] Agregar animaciones de entrada/salida

### TarjetaComercio.vue
[x] Crear estructura bÃ¡sica (layout vertical tipo carta)
[x] Agregar placeholder foto (IconBuilding de Tabler)
[x] Mostrar nombre del comercio
[x] Mostrar tipo de comercio
[x] Mostrar cantidad de direcciones
[x] Implementar estado expandido/colapsado
[x] Mostrar lista de direcciones al expandir
[x] Agregar botÃ³n "Editar" (solo expandido)
[x] Implementar modo selecciÃ³n (checkbox circular)
[x] Implementar long-press (1 segundo)
[x] Agregar estilos responsivos
[x] Agregar animaciones de hover/active
[x] Implementar vibraciÃ³n hÃ¡ptica (Capacitor)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âœ… FASE 4: FORMULARIOS Y VALIDACIONES ğŸ“ [COMPLETADA]

### FormularioComercio.vue
[x] Crear estructura del formulario
[x] Campo: Nombre (q-input obligatorio)
[x] Campo: Tipo (q-select con opciones predefinidas + "Otro")
[x] Campo: Calle y nÃºmero (q-input obligatorio)
[x] Campo: Barrio (q-input opcional)
[x] Campo: Ciudad (q-input opcional)
[x] BotÃ³n placeholder cÃ¡mara (deshabilitado por ahora)
[x] Implementar validaciones bÃ¡sicas
[x] Implementar validaciÃ³n de duplicados (al escribir)
[x] Mostrar feedback visual de validaciÃ³n
[x] MÃ©todo limpiarFormulario()
[x] MÃ©todo validarFormulario()
[x] Emitir evento 'guardar' con datos

### DialogoAgregarComercio.vue
[x] Crear estructura del diÃ¡logo (q-dialog)
[x] Importar FormularioComercio
[x] Implementar botones Guardar/Cancelar
[x] Conectar con comerciosStore.agregarComercio()
[x] Manejar loading al guardar
[x] Mostrar notificaciones (success/error)
[x] Cerrar diÃ¡logo despuÃ©s de guardar
[x] Implementar prop modelValue para v-model

### DialogoCoincidencias.vue
[x] Crear diÃ¡logo de advertencia
[x] Mostrar lista de comercios similares
[x] Mostrar porcentaje de similitud
[x] Botones: "Usar existente" / "Es nuevo, continuar"
[x] Emitir evento con decisiÃ³n del usuario
[x] DiseÃ±o visual claro y amigable

### DialogoMismaUbicacion.vue
[x] Crear diÃ¡logo informativo
[x] Mostrar comercios en misma direcciÃ³n
[x] Explicar que puede ser mismo edificio
[x] Botones: "SÃ­, agregar" / "Cancelar"
[x] Emitir evento con confirmaciÃ³n

### DialogoMotivoEliminacion.vue
[x] Crear diÃ¡logo de confirmaciÃ³n
[x] Radio buttons con opciones:
  [x] - "CerrÃ³ definitivamente"
  [x] - "Error / Duplicado"
  [x] - "Otro motivo"
[x] Campo texto para "Otro motivo"
[x] Mostrar cantidad de productos afectados
[x] Botones: "Confirmar eliminaciÃ³n" / "Cancelar"
[x] Emitir evento con motivo seleccionado

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## â¸ï¸ FASE 5: INTEGRACIÃ“N CON PRECIOS ğŸ”— [PENDIENTE]

### Modificar FormularioPrecio.vue
[ ] Reemplazar q-input comercio por q-select
[ ] Configurar q-select con use-input
[ ] Implementar @filter para bÃºsqueda en tiempo real
[ ] Cargar comercios desde comerciosStore
[ ] Ordenar por Ãºltimos usados
[ ] Agregar opciÃ³n "â• Agregar nuevo comercio"
[ ] Abrir DialogoAgregarComercio si elige "nuevo"
[ ] Actualizar al agregar comercio nuevo
[ ] Implementar autocompletado de direcciÃ³n
[ ] Filtrar direcciones segÃºn comercio seleccionado
[ ] Ordenar direcciones por Ãºltimas usadas
[ ] Registrar uso al guardar precio (ComerciosService)

### Modificar ProductosService.js
[ ] Actualizar estructura de precios
[ ] Guardar comercioId en lugar de string
[ ] Mantener compatibilidad con datos viejos (si los hay)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## â¸ï¸ FASE 6: ELIMINACIÃ“N MÃšLTIPLE âœ… [PENDIENTE]

### Integrar selecciÃ³n mÃºltiple
[ ] Verificar useSeleccionMultiple.js funciona
[ ] Importar en ComerciosPage
[ ] Implementar handleLongPress
[ ] Implementar handleToggleSeleccion
[ ] Implementar seleccionarTodos
[ ] Implementar cancelarSeleccion

### Eliminar comercios con validaciÃ³n
[ ] Abrir DialogoMotivoEliminacion
[ ] Validar si comercios tienen productos asociados
[ ] Mostrar advertencia si tienen productos
[ ] SegÃºn motivo:
  [ ] - CerrÃ³: Marcar productos (mantener historial)
  [ ] - Duplicado: Reasignar a otro comercio
  [ ] - Otro: Mantener precios con nombre original
[ ] Implementar eliminaciÃ³n con animaciÃ³n
[ ] NotificaciÃ³n con botÃ³n "Deshacer" (5 seg)
[ ] Restaurar si elige deshacer

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸš§ FASE 7: ROUTER Y NAVEGACIÃ“N ğŸ—ºï¸ [EN PROGRESO]

### Actualizar routes.js
[ ] Agregar ruta /comercios
[ ] Configurar ComerciosPage como componente
[ ] Verificar navegaciÃ³n desde drawer

### Actualizar MainLayout.vue
[ ] Verificar que el item "Comercios" tenga to="/comercios"
[ ] Confirmar que funciona la navegaciÃ³n

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## FASE 8: TESTING Y AJUSTES ğŸ§ª

### Testing funcional
[ ] Crear comercio nuevo
[ ] Editar comercio existente
[ ] Agregar direcciÃ³n a comercio
[ ] Eliminar direcciÃ³n de comercio
[ ] ValidaciÃ³n de duplicados exactos
[ ] ValidaciÃ³n de direcciones similares
[ ] ValidaciÃ³n de misma ubicaciÃ³n
[ ] BÃºsqueda de comercios
[ ] Filtrado en tiempo real
[ ] Orden por Ãºltimos usados
[ ] SelecciÃ³n mÃºltiple
[ ] EliminaciÃ³n con motivo
[ ] IntegraciÃ³n con FormularioPrecio
[ ] Autocompletado de direcciones
[ ] NavegaciÃ³n entre pÃ¡ginas

### Testing responsivo
[ ] MÃ³vil (xs) - 360px
[ ] Tablet (sm) - 768px
[ ] Desktop (md) - 1024px

### Optimizaciones
[ ] Revisar performance de bÃºsqueda
[ ] Optimizar re-renders
[ ] Verificar memoria (no memory leaks)
[ ] Lazy loading de imÃ¡genes (futuro)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## FASE 9: DOCUMENTACIÃ“N ğŸ“š

### Actualizar ResÃºmenes
[ ] Crear Resumen5Comercios.txt
[ ] Actualizar Resumen1General.txt (features + estructura)
[ ] Actualizar Resumen4FormularioAgregar.txt (integraciÃ³n)

### Comentarios en cÃ³digo
[ ] Documentar funciones complejas
[ ] Agregar JSDoc donde sea necesario
[ ] Comentar algoritmos de validaciÃ³n

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## NOTAS IMPORTANTES ğŸ“Œ

- Fase 1 (Base de datos) âœ… COMPLETADA
- Fase 2 (Estructura) âœ… COMPLETADA
- Fase 3 (UI PÃ¡gina) âœ… COMPLETADA
- Fase 4 (Formularios) âœ… COMPLETADA
- No implementar cÃ¡mara todavÃ­a (placeholder solamente)
- Reutilizar componentes de selecciÃ³n mÃºltiple âœ… HECHO
- Mantener consistencia con diseÃ±o actual âœ… HECHO
- Probar cada fase antes de seguir a la siguiente
- Guardar progreso con commits frecuentes

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## PRÃ“XIMAS MEJORAS (POST-MVP) ğŸš€

[ ] Implementar plugin de cÃ¡mara
[ ] Subir fotos de comercios
[ ] GeolocalizaciÃ³n de comercios
[ ] Mapa de comercios cercanos
[ ] Compartir comercios entre usuarios
[ ] Sistema de reportes de comercios cerrados
[ ] VerificaciÃ³n de comercios (badges)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“Š PROGRESO GENERAL: 60% COMPLETADO

âœ… Fase 1: 100%
âœ… Fase 2: 100%
âœ… Fase 3: 100%
âœ… Fase 4: 100%
â¸ï¸ Fase 5: 0%
â¸ï¸ Fase 6: 0%
ğŸš§ Fase 7: 50%
â¸ï¸ Fase 8: 0%
â¸ï¸ Fase 9: 0%