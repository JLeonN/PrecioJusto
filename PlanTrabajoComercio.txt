# PLAN DE TRABAJO - SECCIÃ“N COMERCIOS
Proyecto: Precio Justo
Fecha inicio: 29 de Enero 2025
Responsable: Leo + CH

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## FASE 1: BASE DE DATOS Y SERVICIOS âš™ï¸

### ComerciosService.js
[ ] Crear archivo en src/almacenamiento/servicios/
[ ] Implementar obtenerTodos()
[ ] Implementar buscarPorNombre()
[ ] Implementar buscarPorId()
[ ] Implementar agregarComercio()
[ ] Implementar editarComercio()
[ ] Implementar eliminarComercio()
[ ] Implementar agregarDireccion()
[ ] Implementar eliminarDireccion()
[ ] Implementar validarDuplicados() (algoritmo 3 niveles)
[ ] Implementar normalizar() (minÃºsculas, tildes, espacios)
[ ] Implementar similitudTexto() (Levenshtein distance)
[ ] Implementar expandirAbreviaturas()
[ ] Implementar registrarUsoComercio() (para orden Ãºltimos usados)
[ ] Implementar obtenerComercioPorUso() (ordenados por fecha)

### comerciosStore.js
[ ] Crear archivo en src/almacenamiento/stores/
[ ] Definir state (comercios, cargando, error)
[ ] Implementar cargarComercios()
[ ] Implementar agregarComercio()
[ ] Implementar editarComercio()
[ ] Implementar eliminarComercio()
[ ] Implementar buscarComercios()
[ ] Implementar obtenerComercioPorId()
[ ] Integrar con ComerciosService

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## FASE 2: ESTRUCTURA DE ARCHIVOS ğŸ“

### ReorganizaciÃ³n de carpetas
[ ] Crear carpeta src/components/Compartidos/
[ ] Mover BarraSeleccion.vue a Compartidos/
[ ] Mover BarraAccionesSeleccion.vue a Compartidos/
[ ] Crear carpeta src/components/Comercios/
[ ] Actualizar imports en MisProductosPage.vue

### Nuevos archivos
[ ] Crear src/pages/ComerciosPage.vue
[ ] Crear src/components/Comercios/ListaComercios.vue
[ ] Crear src/components/Comercios/TarjetaComercio.vue
[ ] Crear src/components/Formularios/FormularioComercio.vue
[ ] Crear src/components/Formularios/Dialogos/DialogoAgregarComercio.vue
[ ] Crear src/components/Formularios/Dialogos/DialogoCoincidencias.vue
[ ] Crear src/components/Formularios/Dialogos/DialogoMismaUbicacion.vue
[ ] Crear src/components/Formularios/Dialogos/DialogoMotivoEliminacion.vue

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## FASE 3: UI - PÃGINA DE COMERCIOS ğŸ¨

### ComerciosPage.vue
[ ] Crear estructura bÃ¡sica del layout
[ ] Importar ListaComercios
[ ] Implementar carga de comercios desde store
[ ] Agregar botÃ³n FAB para nuevo comercio
[ ] Implementar estados: cargando, vacÃ­o, error
[ ] Agregar barra de bÃºsqueda
[ ] Integrar modo selecciÃ³n mÃºltiple
[ ] Conectar con BarraSeleccion (Compartidos)
[ ] Conectar con BarraAccionesSeleccion (Compartidos)

### ListaComercios.vue
[ ] Crear componente contenedor
[ ] Recibir props: comercios, modoSeleccion, seleccionados
[ ] Renderizar TarjetaComercio por cada comercio
[ ] Implementar mensaje "No hay comercios"
[ ] Manejar eventos de selecciÃ³n
[ ] Agregar animaciones de entrada/salida

### TarjetaComercio.vue
[ ] Crear estructura bÃ¡sica (layout vertical tipo carta)
[ ] Agregar placeholder foto (IconBuilding de Tabler)
[ ] Mostrar nombre del comercio
[ ] Mostrar tipo de comercio
[ ] Mostrar cantidad de direcciones
[ ] Implementar estado expandido/colapsado
[ ] Mostrar lista de direcciones al expandir
[ ] Agregar botÃ³n "Editar" (solo expandido)
[ ] Implementar modo selecciÃ³n (checkbox circular)
[ ] Implementar long-press (1 segundo)
[ ] Agregar estilos responsivos
[ ] Agregar animaciones de hover/active
[ ] Implementar vibraciÃ³n hÃ¡ptica (Capacitor)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## FASE 4: FORMULARIOS Y VALIDACIONES ğŸ“

### FormularioComercio.vue
[ ] Crear estructura del formulario
[ ] Campo: Nombre (q-input obligatorio)
[ ] Campo: Tipo (q-select con opciones predefinidas + "Otro")
[ ] Campo: Calle y nÃºmero (q-input obligatorio)
[ ] Campo: Barrio (q-input opcional)
[ ] Campo: Ciudad (q-input opcional)
[ ] BotÃ³n placeholder cÃ¡mara (deshabilitado por ahora)
[ ] Implementar validaciones bÃ¡sicas
[ ] Implementar validaciÃ³n de duplicados (al escribir)
[ ] Mostrar feedback visual de validaciÃ³n
[ ] MÃ©todo limpiarFormulario()
[ ] MÃ©todo validarFormulario()
[ ] Emitir evento 'guardar' con datos

### DialogoAgregarComercio.vue
[ ] Crear estructura del diÃ¡logo (q-dialog)
[ ] Importar FormularioComercio
[ ] Implementar botones Guardar/Cancelar
[ ] Conectar con comerciosStore.agregarComercio()
[ ] Manejar loading al guardar
[ ] Mostrar notificaciones (success/error)
[ ] Cerrar diÃ¡logo despuÃ©s de guardar
[ ] Implementar prop modelValue para v-model

### DialogoCoincidencias.vue
[ ] Crear diÃ¡logo de advertencia
[ ] Mostrar lista de comercios similares
[ ] Mostrar porcentaje de similitud
[ ] Botones: "Usar existente" / "Es nuevo, continuar"
[ ] Emitir evento con decisiÃ³n del usuario
[ ] DiseÃ±o visual claro y amigable

### DialogoMismaUbicacion.vue
[ ] Crear diÃ¡logo informativo
[ ] Mostrar comercios en misma direcciÃ³n
[ ] Explicar que puede ser mismo edificio
[ ] Botones: "SÃ­, agregar" / "Cancelar"
[ ] Emitir evento con confirmaciÃ³n

### DialogoMotivoEliminacion.vue
[ ] Crear diÃ¡logo de confirmaciÃ³n
[ ] Radio buttons con opciones:
  [ ] - "CerrÃ³ definitivamente"
  [ ] - "Error / Duplicado"
  [ ] - "Otro motivo"
[ ] Campo texto para "Otro motivo"
[ ] Mostrar cantidad de productos afectados
[ ] Botones: "Confirmar eliminaciÃ³n" / "Cancelar"
[ ] Emitir evento con motivo seleccionado

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## FASE 5: INTEGRACIÃ“N CON PRECIOS ğŸ”—

### Modificar FormularioPrecio.vue
[ ] Reemplazar q-input comercio por q-select
[ ] Configurar q-select con use-input
[ ] Implementar @filter para bÃºsqueda en tiempo real
[ ] Cargar comercios desde comerciosStore
[ ] Ordenar por Ãºltimos usados
[ ] Agregar opciÃ³n "â• Agregar nuevo comercio"
[ ] Abrir DialogoAgregarComercio si elige "nuevo"
[ ] Actualizar al agregar comercio nuevo
[ ] Implementar autocompletado de direcciÃ³n
[ ] Filtrar direcciones segÃºn comercio seleccionado
[ ] Ordenar direcciones por Ãºltimas usadas
[ ] Registrar uso al guardar precio (ComerciosService)

### Modificar ProductosService.js
[ ] Actualizar estructura de precios
[ ] Guardar comercioId en lugar de string
[ ] Mantener compatibilidad con datos viejos (si los hay)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## FASE 6: ELIMINACIÃ“N MÃšLTIPLE âœ…

### Integrar selecciÃ³n mÃºltiple
[ ] Verificar useSeleccionMultiple.js funciona
[ ] Importar en ComerciosPage
[ ] Implementar handleLongPress
[ ] Implementar handleToggleSeleccion
[ ] Implementar seleccionarTodos
[ ] Implementar cancelarSeleccion

### Eliminar comercios con validaciÃ³n
[ ] Abrir DialogoMotivoEliminacion
[ ] Validar si comercios tienen productos asociados
[ ] Mostrar advertencia si tienen productos
[ ] SegÃºn motivo:
  [ ] - CerrÃ³: Marcar productos (mantener historial)
  [ ] - Duplicado: Reasignar a otro comercio
  [ ] - Otro: Mantener precios con nombre original
[ ] Implementar eliminaciÃ³n con animaciÃ³n
[ ] NotificaciÃ³n con botÃ³n "Deshacer" (5 seg)
[ ] Restaurar si elige deshacer

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## FASE 7: ROUTER Y NAVEGACIÃ“N ğŸ—ºï¸

### Actualizar routes.js
[ ] Agregar ruta /comercios
[ ] Configurar ComerciosPage como componente
[ ] Verificar navegaciÃ³n desde drawer

### Actualizar MainLayout.vue
[ ] Verificar que el item "Comercios" tenga to="/comercios"
[ ] Confirmar que funciona la navegaciÃ³n

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## FASE 8: TESTING Y AJUSTES ğŸ§ª

### Testing funcional
[ ] Crear comercio nuevo
[ ] Editar comercio existente
[ ] Agregar direcciÃ³n a comercio
[ ] Eliminar direcciÃ³n de comercio
[ ] ValidaciÃ³n de duplicados exactos
[ ] ValidaciÃ³n de direcciones similares
[ ] ValidaciÃ³n de misma ubicaciÃ³n
[ ] BÃºsqueda de comercios
[ ] Filtrado en tiempo real
[ ] Orden por Ãºltimos usados
[ ] SelecciÃ³n mÃºltiple
[ ] EliminaciÃ³n con motivo
[ ] IntegraciÃ³n con FormularioPrecio
[ ] Autocompletado de direcciones
[ ] NavegaciÃ³n entre pÃ¡ginas

### Testing responsivo
[ ] MÃ³vil (xs) - 360px
[ ] Tablet (sm) - 768px
[ ] Desktop (md) - 1024px

### Optimizaciones
[ ] Revisar performance de bÃºsqueda
[ ] Optimizar re-renders
[ ] Verificar memoria (no memory leaks)
[ ] Lazy loading de imÃ¡genes (futuro)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## FASE 9: DOCUMENTACIÃ“N ğŸ“š

### Actualizar ResÃºmenes
[ ] Crear Resumen5Comercios.txt
[ ] Actualizar Resumen1General.txt (features + estructura)
[ ] Actualizar Resumen4FormularioAgregar.txt (integraciÃ³n)

### Comentarios en cÃ³digo
[ ] Documentar funciones complejas
[ ] Agregar JSDoc donde sea necesario
[ ] Comentar algoritmos de validaciÃ³n

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## NOTAS IMPORTANTES ğŸ“Œ

- Fase 1 (Base de datos) es CRÃTICA, hacerla primero
- No implementar cÃ¡mara todavÃ­a (placeholder solamente)
- Reutilizar componentes de selecciÃ³n mÃºltiple
- Mantener consistencia con diseÃ±o actual
- Probar cada fase antes de seguir a la siguiente
- Guardar progreso con commits frecuentes

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## PRÃ“XIMAS MEJORAS (POST-MVP) ğŸš€

[ ] Implementar plugin de cÃ¡mara
[ ] Subir fotos de comercios
[ ] GeolocalizaciÃ³n de comercios
[ ] Mapa de comercios cercanos
[ ] Compartir comercios entre usuarios
[ ] Sistema de reportes de comercios cerrados
[ ] VerificaciÃ³n de comercios (badges)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•